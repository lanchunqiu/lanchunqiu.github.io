<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Rediså®æˆ˜, lanchunqiu.github.io">
    <meta name="description" content="åˆè¯†Redisä¸€èˆ¬æ¥è¯´ï¼Œç¼“å­˜å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š

åº”ç”¨å†…ç¼“å­˜ï¼Œæ¯”å¦‚Javaçš„Mapã€Setç­‰ç®€å•æ•°æ®ç»“æ„ï¼Œä»¥åŠEhcacheç­‰ä¸‰æ–¹åº“ï¼›
ç‹¬ç«‹çš„ç¼“å­˜æœåŠ¡ï¼ˆç»„ä»¶ï¼‰ï¼Œæ¯”å¦‚Memcachedã€Redisï¼›

Redisï¼ˆRemote Dictiona">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Rediså®æˆ˜ | lanchunqiu.github.io</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">lanchunqiu.github.io</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>é¦–é¡µ</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>æ ‡ç­¾</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>åˆ†ç±»</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>å½’æ¡£</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>å…³äº</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>å‹æƒ…é“¾æ¥</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="æœç´¢"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">lanchunqiu.github.io</div>
        <div class="logo-desc">
            
            æ¬¢è¿è®¿é—®æˆ‘çš„åšå®¢å°ç«™
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                é¦–é¡µ
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                æ ‡ç­¾
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                åˆ†ç±»
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                å½’æ¡£
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                å…³äº
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                å‹æƒ…é“¾æ¥
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/lanchunqiu" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/lanchunqiu" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewbox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/>
    </svg>
</a>
        
    </nav>

</header>





<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/11.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Rediså®æˆ˜
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }
</style>
<div class="row">
    <div class="col s12 m12 l9">
        <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Java/" target="_blank">
                                <span class="chip bg-color">Java</span>
                            </a>
                        
                            <a href="/tags/Redis/" target="_blank">
                                <span class="chip bg-color">Redis</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Redis/" class="post-category" target="_blank">
                                Redis
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2019-03-20
                </div>

                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>é˜…è¯»æ¬¡æ•°:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="åˆè¯†Redis"><a href="#åˆè¯†Redis" class="headerlink" title="åˆè¯†Redis"></a>åˆè¯†Redis</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œç¼“å­˜å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p>
<ul>
<li>åº”ç”¨å†…ç¼“å­˜ï¼Œæ¯”å¦‚Javaçš„Mapã€Setç­‰ç®€å•æ•°æ®ç»“æ„ï¼Œä»¥åŠEhcacheç­‰ä¸‰æ–¹åº“ï¼›</li>
<li>ç‹¬ç«‹çš„ç¼“å­˜æœåŠ¡ï¼ˆç»„ä»¶ï¼‰ï¼Œæ¯”å¦‚Memcachedã€Redisï¼›</li>
</ul>
<p>Redisï¼ˆRemote Dictionary Serverï¼‰è¿œç¨‹å­—å…¸æœåŠ¡å™¨ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäºkey-valueçš„é«˜æ€§èƒ½çš„å­˜å‚¨ç³»ç»Ÿï¼Œå®ƒæä¾›äº†5ç§é”®å€¼æ•°æ®ç±»å‹æ¥é€‚åº”ä¸åŒåœºæ™¯ä¸‹çš„ç¼“å­˜ä¸å­˜å‚¨éœ€æ±‚ã€‚Redisæ˜¯ä¸€ç§é€Ÿåº¦éå¸¸å¿«çš„éå…³ç³»æ•°æ®åº“ï¼Œå®ƒé™¤äº†æ€§èƒ½å¼ºåŠ²ä¹‹å¤–è¿˜å…·æœ‰å¤åˆ¶ã€æŒä¹…åŒ–ã€åˆ†ç‰‡ã€äº‹ç‰©ç­‰ç‰¹æ€§ï¼Œç”¨æˆ·å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†Redisæ‰©å±•æˆä¸€ä¸ªèƒ½å¤ŸåŒ…å«æ•°ç™¾Gæ•°æ®ã€æ¯ç§’å¤„ç†ä¸Šç™¾ä¸‡æ¬¡è¯·æ±‚çš„ç³»ç»Ÿã€‚</p>
<p>å¦‚ä¸‹è¡¨Rediså’Œå…¶ä»–ä¸€äº›éå…³ç³»æ•°æ®åº“çš„æ¯”è¾ƒã€‚</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>ç±»å‹</th>
<th>æ•°æ®å­˜å‚¨</th>
<th>ç‰¹æ€§</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Redis</td>
<td>å†…å­˜å­˜å‚¨éå…³ç³»é”®å€¼æ•°æ®åº“</td>
<td>å­—ç¬¦ä¸²ã€åˆ—è¡¨ã€æ•£åˆ—ã€é›†åˆã€æœ‰åºé›†åˆ</td>
<td>ä¸»ä»å¤åˆ¶ã€æŒä¹…åŒ–ã€åˆ†ç‰‡ã€å‘å¸ƒä¸è®¢é˜…ï¼ŒLuaè„šæœ¬</td>
<td></td>
</tr>
<tr>
<td>Memcached</td>
<td>å†…å­˜å­˜å‚¨é”®å€¼ç¼“å­˜</td>
<td>é”®å€¼å…³ç³»æ˜ å°„</td>
<td></td>
<td></td>
</tr>
<tr>
<td>MongoDB</td>
<td>ç¡¬ç›˜å­˜å‚¨éå…³ç³»æ–‡æ¡£å‹æ•°æ®åº“</td>
<td>BSONæ–‡æ¡£ï¼ˆç±»ä¼¼jsonæ ¼å¼ï¼‰</td>
<td>æ”¯æŒMap-Reduceæ“ä½œã€ä¸»ä»å¤åˆ¶ã€åˆ†ç‰‡ã€ç©ºé—´ç´¢å¼•</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="Redisçš„å®‰è£…"><a href="#Redisçš„å®‰è£…" class="headerlink" title="Redisçš„å®‰è£…"></a>Redisçš„å®‰è£…</h2><p>Redisçº¦å®šæ¬¡ç‰ˆæœ¬å·ï¼ˆç¬¬ä¸€ä¸ªå°æ•°ç‚¹åçš„æ•°å­—ï¼‰ä¸ºå¶æ•°æ˜¯ç¨³å®šç‰ˆæœ¬ï¼Œä¾‹å¦‚2.8ã€3.0ã€3.2ï¼Œæ¬¡ç‰ˆæœ¬å·ä¸ºåŸºæ•°æ—¶æ˜¯éç¨³å®šç‰ˆæœ¬ã€‚</p>
<h3 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a>å®‰è£…æ­¥éª¤</h3><ol>
<li>ä¸‹è½½Rediså®‰è£…åŒ…ï¼Œ<a href="http://download.redis.io/releases/" target="_blank" rel="noopener">http://download.redis.io/releases/</a></li>
<li>tar -zxvfè§£å‹å®‰è£…åŒ…;</li>
<li>cdåˆ°è§£å‹åçš„ç›®å½•;</li>
<li>æ‰§è¡Œmakeç¼–è¯‘;</li>
<li>æµ‹è¯•ç¼–è¯‘çŠ¶æ€ï¼Œ make test;</li>
<li>make install {prefix=/path/â€¦/â€¦}  å®‰è£…;</li>
</ol>
<h3 id="å¯åŠ¨å’Œåœæ­¢"><a href="#å¯åŠ¨å’Œåœæ­¢" class="headerlink" title="å¯åŠ¨å’Œåœæ­¢"></a>å¯åŠ¨å’Œåœæ­¢</h3><p>Rediså®‰è£…å®Œæˆä¹‹åï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€äº›å¯æ‰§è¡Œæ–‡ä»¶ï¼š</p>
<ul>
<li><p><strong>redis-server</strong>ï¼šredisæœåŠ¡ç«¯</p>
</li>
<li><p><strong>redis-cli</strong>ï¼šrediså‘½ä»¤è¡Œå®¢æˆ·ç«¯</p>
</li>
<li><p><strong>redis-sentinel</strong>ï¼šsentinelæœåŠ¡ï¼ˆ2.8ä»¥åï¼‰</p>
</li>
<li><p><strong>redis-check-rdb</strong>ï¼šrdbæ–‡ä»¶æ£€æŸ¥å·¥å…·</p>
</li>
<li><p><strong>redis-check-aof</strong>ï¼šaofæ–‡ä»¶ä¿®å¤å·¥å…·</p>
</li>
<li><p><strong>redis-benchmark</strong>ï¼šredisæ€§èƒ½æµ‹è¯•å·¥å…·</p>
</li>
</ul>
<p>å¸¸ç”¨çš„å‘½ä»¤æ˜¯redis-serverå’Œredis-cli</p>
<p>1.å¯åŠ¨æœåŠ¡</p>
<pre><code>redis-server /path/redis.conf
</code></pre><p>æœåŠ¡å™¨å¯åŠ¨åé»˜è®¤ç«¯å£æ˜¯6379ï¼Œå¯ä»¥â€“portè‡ªå®šä¹‰ç«¯å£ã€‚ï¼ˆ6379åœ¨æ‰‹æœºé”®ç›˜ä¸Šä¸MERZå¯¹åº”ï¼ŒMERZæ˜¯ä¸€åæ„å¤§åˆ©æ­Œå¥³çš„åå­—ï¼‰å¦‚æœæƒ³ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼å¯åŠ¨ï¼Œéœ€è¦ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶ï¼ŒæŠŠdaemonizeè®¾ç½®ä¸ºyesã€‚</p>
<p>2.åœæ­¢æœåŠ¡</p>
<pre><code>redis-cli shutdown
</code></pre><p>è€ƒè™‘åˆ°RedisæœåŠ¡æœ‰å¯èƒ½æ­£åœ¨å°†å†…å­˜çš„æ•°æ®åŒæ­¥åˆ°ç£ç›˜ä¸­ï¼Œå¼ºè¡Œç»ˆæ­¢Redisè¿›ç¨‹å¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼Œæ­£ç¡®åœæ­¢Redisçš„æ–¹å¼æ˜¯å‘Rediså‘é€shutdownå‘½ä»¤ã€‚å½“RedisæœåŠ¡æ”¶åˆ°shutdownå‘½ä»¤åï¼Œä¼šå…ˆæ–­å¼€æ‰€æœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œç„¶åæ ¹æ®é…ç½®è¿›è¡ŒæŒä¹…åŒ–ï¼Œæœ€ç»ˆå®Œæˆé€€å‡ºã€‚</p>
<h2 id="æ•°æ®ç»“æ„ç±»å‹"><a href="#æ•°æ®ç»“æ„ç±»å‹" class="headerlink" title="æ•°æ®ç»“æ„ç±»å‹"></a>æ•°æ®ç»“æ„ç±»å‹</h2><p>Rediså¯ä»¥å­˜å‚¨é”®ä¸5ç§ä¸åŒæ•°æ®ç»“æ„ç±»å‹ä¹‹é—´çš„æ˜ å°„ï¼Œè¿™5ç§æ•°æ®ç»“æ„ç±»å‹åˆ†åˆ«ä¸ºå­—ç¬¦ä¸²ï¼ˆstringï¼‰ï¼Œåˆ—è¡¨ï¼ˆlistï¼‰ï¼Œé›†åˆï¼ˆsetï¼‰ï¼Œæœ‰åºé›†åˆï¼ˆzsetï¼‰ï¼Œå“ˆå¸Œï¼ˆhashï¼‰ã€‚</p>
<p><strong>Redisæä¾›çš„5ç§æ•°æ®ç»“æ„ç±»å‹</strong></p>
<table>
<thead>
<tr>
<th>ç»“æ„ç±»å‹</th>
<th>ç»“æ„å­˜å‚¨çš„å€¼</th>
<th>ç»“æ„çš„è¯»å†™èƒ½åŠ›</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRING</td>
<td>å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•´æ•°æˆ–æµ®ç‚¹æ•°</td>
<td>å¯¹æ•´ä¸ªå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†æ”¯çº¿æ“ä½œï¼›å¯¹æ•´æ•°å’Œæµ®ç‚¹æ•°æ‰§è¡Œè‡ªå¢ï¼ˆincrementï¼‰æˆ–è‡ªå‡ï¼ˆdecrementï¼‰æ“ä½œ</td>
</tr>
<tr>
<td>LIST</td>
<td>ä¸€ä¸ªé“¾è¡¨ï¼Œé“¾è¡¨ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«äº†ä¸€ä¸ªå­—ç¬¦ä¸²</td>
<td>ä»é“¾è¡¨çš„ä¸¤ç«¯æ¨å…¥æˆ–è€…å¼¹å‡ºå…ƒç´ ï¼›æ ¹æ®åç§»é‡å¯¹é“¾è¡¨è¿›è¡Œä¿®å‰ª(trim)ï¼›è¯»å–å•ä¸ªæˆ–è€…å¤šä¸ªå…ƒç´ ï¼›æ ¹æ®å€¼æŸ¥æ‰¾æˆ–è€…ç§»é™¤å…ƒç´ </td>
</tr>
<tr>
<td>SET</td>
<td>åŒ…å«å­—ç¬¦ä¸²çš„æ— åºæ”¶é›†å™¨ï¼Œå¹¶ä¸”è¢«å­—ç¬¦ä¸²ä¸èƒ½é‡å¤ï¼Œå„ä¸ç›¸åŒ</td>
<td>æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªå…ƒç´ ï¼›æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ï¼›è®¡ç®—äº¤é›†ã€å¹¶é›†ã€å·®é›†ï¼›ä»é›†åˆé‡Œé¢éšæœºå–å…ƒç´ </td>
</tr>
<tr>
<td>ZSET</td>
<td>å­—ç¬¦æˆå‘˜ä¸æµ®ç‚¹æ•°åˆ†å€¼ä¹‹é—´çš„æœ‰åºæ˜ å°„ï¼Œå…ƒç´ çš„æ’åˆ—é¡ºåºç”±åˆ†å€¼çš„å¤§å°å†³å®š</td>
<td>æ·»åŠ ã€è·å–ã€åˆ é™¤å•ä¸ªå…ƒç´ ï¼›æ ¹æ®åˆ†å€¼èŒƒå›´æˆ–è€…æˆå‘˜æ¥è·å–å…ƒç´ </td>
</tr>
<tr>
<td>HASH</td>
<td>åŒ…å«é”®å€¼å¯¹çš„æ— åºæ•£åˆ—è¡¨</td>
<td>æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªé”®å€¼å¯¹ï¼›è·å–æ‰€ä»¥é”®å€¼å¯¹</td>
</tr>
</tbody>
</table>
<h3 id="å­—ç¬¦ä¸²-String"><a href="#å­—ç¬¦ä¸²-String" class="headerlink" title="å­—ç¬¦ä¸²(String)"></a>å­—ç¬¦ä¸²(String)</h3><p>å­—ç¬¦ä¸²(string)ç±»å‹æ˜¯redisä¸­æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œå®ƒèƒ½å­˜å‚¨ä»»ä½•å½¢å¼çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ•°æ®ã€‚å¯ä»¥ç”¨å®ƒæ¥å­˜å‚¨ç”¨æˆ·çš„é‚®ç®±ã€jsonåŒ–å¯¹è±¡ã€ç”šè‡³æ˜¯å›¾ç‰‡ã€‚ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹é”®å…è®¸å­˜å‚¨çš„æœ€å¤§å®¹é‡æ˜¯512Mã€‚</p>
<h4 id="å†…éƒ¨æ•°æ®ç»“æ„"><a href="#å†…éƒ¨æ•°æ®ç»“æ„" class="headerlink" title="å†…éƒ¨æ•°æ®ç»“æ„"></a>å†…éƒ¨æ•°æ®ç»“æ„</h4><p>åœ¨Rediså†…éƒ¨ï¼ŒStringç±»å‹é€šè¿‡intã€sds(simple dynamic string)ä½œä¸ºå­˜å‚¨ç»“æ„ï¼Œintç”¨æ¥å­˜æ”¾æ•´å‹æ•°æ®ï¼Œsdså­˜æ”¾å­—èŠ‚ã€å­—ç¬¦ä¸²ã€æµ®ç‚¹å‹æ•°æ®ã€‚åœ¨Cçš„æ ‡å‡†å­—ç¬¦ä¸²ç»“æ„ä¸‹è¿›è¡Œäº†å°è£…ï¼Œç”¨æ¥æå‡åŸºæœ¬æ“ä½œçš„æ€§èƒ½ï¼ŒåŒæ—¶ä¹Ÿå……åˆ†åˆ©ç”¨å·²æœ‰çš„Cæ ‡å‡†åº“ï¼Œç®€åŒ–å®ç°é€»è¾‘ã€‚å¯ä»¥åœ¨Redisçš„æºç ä¸­[sds.h]ä¸­çœ‹åˆ°çš„ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">char</span> <span class="token operator">*</span>sds<span class="token punctuation">;</span>
</code></pre>
<p>redis3.2ç‰ˆæœ¬ä¹‹åå¼•å…¥äº†5ç§sdshdrç±»å‹ï¼Œç›®çš„æ˜¯ä¸ºäº†æ»¡è¶³ä¸åŒé•¿åº¦å­—ç¬¦ä¸²å¯ä»¥ä½¿ç”¨ä¸åŒå¤§å°çš„sdshdrï¼Œä»è€ŒèŠ‚çœå†…å­˜ï¼Œæ¯æ¬¡åˆ›å»ºä¸€ä¸ªsdsæ—¶æ ¹æ®sdsçš„å®é™…é•¿åº¦åˆ¤æ–­åº”è¯¥é€‰æ‹©ä»€ä¹ˆç±»å‹çš„sdshdrã€‚sdshdrçš„5ä¸­ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/* Note: sdshdr5 is never used, we just access the flags byte directly.
 * However is here to document the layout of type 5 SDS strings. */</span>
<span class="token keyword">struct</span> <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> sdshdr5 <span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 3 lsb of type, and 5 msb of string length */</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> sdshdr8 <span class="token punctuation">{</span>
    uint8_t len<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* used */</span>
    uint8_t alloc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* excluding the header and null terminator */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 3 lsb of type, 5 unused bits */</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> sdshdr16 <span class="token punctuation">{</span>
    uint16_t len<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* used */</span>
    uint16_t alloc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* excluding the header and null terminator */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 3 lsb of type, 5 unused bits */</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> sdshdr32 <span class="token punctuation">{</span>
    uint32_t len<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* used */</span>
    uint32_t alloc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* excluding the header and null terminator */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 3 lsb of type, 5 unused bits */</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> sdshdr64 <span class="token punctuation">{</span>
    uint64_t len<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* used */</span>
    uint64_t alloc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* excluding the header and null terminator */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* 3 lsb of type, 5 unused bits */</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>ä»¥sdshdr8ä¸ºä¾‹ï¼Œæ¥è§£é‡Šä¸€ä¸‹ï¼Œ8è¡¨ç¤ºå­—ç¬¦ä¸²æœ€å¤§é•¿åº¦æ˜¯<code>2^8-1</code>å³255</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">struct</span> <span class="token function">__attribute__</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>__packed__<span class="token punctuation">)</span><span class="token punctuation">)</span> sdshdr8 <span class="token punctuation">{</span>
    uint8_t len<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è¡¨ç¤ºå½“å‰sdsçš„é•¿åº¦(å•ä½æ˜¯å­—èŠ‚)</span>
    uint8_t alloc<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//è¡¨ç¤ºsdså·²åˆ†é…å†…å­˜å¤§å°(å•ä½æ˜¯å­—èŠ‚)</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> flags<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//ç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºå½“å‰sdshdrçš„ç±»å‹ï¼Œåº”ä¸ºsdshdræœ‰5ç§ç±»å‹ï¼Œæ‰€ä»¥è‡³å°‘éœ€è¦3ä½æ¥è¡¨ç¤ºï¼š000--sdshdr5ã€001--shshdr8ã€010--sdshdr16ã€011--sdshdr32ã€100--sdshdr64ï¼Œé«˜5ä½ç”¨ä¸åˆ°æ‰€ä»¥éƒ½æ˜¯0</span>
    <span class="token keyword">char</span> buf<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å­—èŠ‚æ•°æ®ï¼Œç”¨äºä¿å­˜å­—ç¬¦ä¸²</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p><img src="/2019/03/20/RedisInAction/sdshdr8.png" alt></p>
<p>SDSéµå¾ªCå­—ç¬¦ä¸²ä»¥ç©ºå­—ç¬¦ç»“å°¾çš„æƒ¯ä¾‹ã€‚</p>
<h4 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><ol>
<li><p><strong>append</strong>ï¼š append key valueï¼› å¦‚æœkeyå·²ç»å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œappendå‘½ä»¤å°†valueè¿½åŠ åˆ°åŸç†å€¼å¾—æœ«å°¾ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</p>
</li>
<li><p><strong>bitcount</strong>ï¼šbitcount key [start end]ï¼› ç»Ÿè®¡å­—ç¬¦ä¸²ä¸­ï¼Œè¢«è®¾ç½®ä¸º1çš„æ¯”ç‰¹ä½çš„æ•°é‡ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.6.0ã€‚</p>
</li>
<li><p><strong>bitop</strong>ï¼šbitop operation destkey key [key â€¦] ï¼›å¯¹ä¸€ä¸ªæˆ–å¤šä¸ªä¿å­˜äºŒè¿›åˆ¶ä½çš„å­—ç¬¦ä¸²keyè¿›è¡Œä½å…ƒæ“ä½œï¼Œå¹¶å°†ç»“æœä¿å­˜åˆ°destkeyä¸Šã€‚operationå¯ä»¥æ˜¯ANDã€ORã€NOTã€XORè¿™å››ç§æ“ä½œä¸­çš„ä»»æ„ä¸€ç§ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.6.0ã€‚</p>
</li>
<li><p><strong>decr</strong>ï¼šdecr key ï¼›å°†keyä¸­å­˜å‚¨çš„æ•°æ®å€¼å‡1ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>decrby</strong>ï¼šdecrby key decrementï¼›å°†keyæ‰€å­˜å‚¨çš„å€¼å‡å»decrementã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>get</strong>ï¼šget keyï¼›è¿”å›Keyæ‰€å¯¹åº”çš„æ”¯ä»˜ä¸²çš„å€¼ã€‚å¦‚æœ keyä¸å­˜åœ¨é‚£ä¹ˆè¿”å›ç‰¹æ®Šå€¼ nil ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>getbit</strong>ï¼šgetbit key offsetï¼›å¯¹keyæ‰€å­˜å‚¨çš„å­—ç¬¦ä¸²å€¼ï¼Œè·å–æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.2.0ã€‚</p>
</li>
<li><p><strong>getrange</strong>ï¼šgetrange key start endï¼›æˆªå–å¾—å‡ºå­å­—ç¬¦ä¸²ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.4.0</p>
</li>
<li><p><strong>getset</strong>ï¼šgetset key valueï¼›å°†ç»™å®škeyçš„å€¼è®¾ä¸ºvalueï¼Œå¹¶è¿”å›keyçš„æ—§å€¼ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>incr</strong>ï¼šincr keyï¼›å°†keyä¸­å­˜å‚¨çš„æ•°å­—å€¼å¢ä¸€ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0</p>
</li>
<li><p><strong>incrby</strong>ï¼šincrby key incrementï¼›å°†keyæ‰€å­˜å‚¨çš„å€¼åŠ ä¸Šå¢é‡incrementã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>incrbyfloat</strong>ï¼šincrbyfloat key incrementï¼›ä¸ºkeyä¸­æ‰€å­˜å‚¨çš„å€¼åŠ ä¸Šæµ®ç‚¹æ•°å¢é‡incrementã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.6.0</p>
</li>
<li><p><strong>mget</strong>ï¼šmget key [key â€¦] ï¼›è¿”å›æ‰€æœ‰(ä¸€ä¸ªæˆ–å¤šä¸ª)ç»™å®škeyçš„å€¼ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>mset</strong>ï¼šmset key value [key value â€¦] ï¼›åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªkey-valueå¯¹ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.1</p>
</li>
<li><p><strong>msetnx</strong>ï¼šmsetnx key value [key value â€¦]ï¼› åŒæ—¶è®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªkey-valueå¯¹ï¼Œå½“ä¸”ä»…å½“æ‰€æœ‰ç»™å®šçš„keyéƒ½ä¸å­˜åœ¨ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.1ã€‚</p>
</li>
<li><p><strong>psetnx</strong>ï¼špsetnx key milliseconds valueï¼› è¿™ä¸ªå‘½ä»¤å’Œsetexå‘½ä»¤ç›¸è¯†ï¼Œä½†å®ƒä»¥æ¯«ç§’ä¸ºå•ä½è®¾ç½®keyçš„ç”Ÿå­˜æ—¶é—´ï¼Œè€Œä¸æ˜¯åƒsetexå‘½ä»¤é‚£æ ·ï¼Œä»¥ç§’ä¸ºå•ä½ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.6.0ã€‚</p>
</li>
<li><p><strong>set</strong>ï¼šset key value [EX seconds] [PX milliseconds] [NX|XX]ï¼›å°†å­—ç¬¦ä¸²valueå…³è”åˆ°keyã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
<p>ä»ç‰ˆæœ¬2.6.12å¼€å§‹ï¼Œsetå‘½ä»¤çš„è¡Œä¸ºå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—å‚æ•°æ¥ä¿®æ”¹ï¼š</p>
<ul>
<li><p>EX seconds:è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´ä¸ºsecondç§’ï¼Œset key value ex second æ•ˆæœç­‰åŒäºsetex key second valueï¼›</p>
</li>
<li><p>PX milliseconds:è®¾ç½®é”®çš„è¿‡æœŸæ—¶é—´ä¸ºmillisecondæ¯«ç§’ã€‚set key value px millisecondæ•ˆæœç­‰åŒäºpsetex key millisecond valueï¼›</p>
</li>
<li>NX:åªæœ‰é”®ä¸å­˜åœ¨æ—¶ï¼Œæ‰å¯¹é”®è¿›è¡Œè®¾ç½®æ“ä½œï¼Œset key value nx æ•ˆæœç­‰åŒäºsetnx key valueï¼›</li>
<li>XX:åªåœ¨é”®å·²ç»å­˜åœ¨æ—¶ï¼Œæ‰å¯¹é”®è¿›è¡Œè®¾ç½®æ“ä½œã€‚</li>
</ul>
</li>
<li><p><strong>setbit</strong>ï¼šsetbit key offset valueï¼›å¯¹keyæ‰€å­˜å‚¨çš„å­—ç¬¦ä¸²å€¼ï¼Œè®¾ç½®æˆ–æ¸…é™¤æŒ‡å®šåç§»é‡ä¸Šçš„ä½(bit)ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.2.0ã€‚</p>
</li>
<li><p><strong>setex</strong>ï¼šsetex key seconds valueï¼›å°†å€¼valueå…³è”åˆ°keyï¼Œå¹¶å°†keyçš„ç”Ÿå­˜æ—¶é—´è®¾ç½®ä¸ºsecondsç§’ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</p>
</li>
<li><p><strong>setnx</strong>ï¼šsetnx key valueï¼›å°†keyçš„å€¼è®¾ä¸ºvalueï¼Œå½“ä¸”ä»…å½“keyä¸å­˜åœ¨ã€‚è®¾ç½®æˆåŠŸï¼Œè¿”å›1ï¼›è®¾ç½®å¤±è´¥ï¼Œè¿”å›0ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>setrange</strong>ï¼šsetrange key offset valueï¼›ç”¨valueè¦†ç›–ç»™å®škeyæ‰€å­˜åœ¨çš„å­—ç¬¦ä¸²å€¼ï¼Œä»åç§»é‡offsetå¼€å§‹ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.2.0ã€‚</p>
</li>
<li><p><strong>strlen</strong>ï¼šstrlen keyï¼›è¿”å›keyæ‰€å­˜å‚¨çš„å­—ç¬¦ä¸²å€¼å¾—é•¿åº¦ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.2.0ã€‚</p>
</li>
</ol>
<h3 id="åˆ—è¡¨-List"><a href="#åˆ—è¡¨-List" class="headerlink" title="åˆ—è¡¨(List)"></a>åˆ—è¡¨(List)</h3><p>åˆ—è¡¨(list)ç±»å‹å¯ä»¥å­˜å‚¨ä¸€ä¸ªæœ‰åºçš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¸¸ç”¨çš„æ“ä½œæ˜¯å‘åˆ—è¡¨çš„ä¸¤ç«¯æ·»åŠ å…ƒç´ æˆ–è€…è·å–åˆ—è¡¨çš„æŸä¸ªç‰‡æ®µã€‚</p>
<p> åˆ—è¡¨ç±»å‹ä½¿ç”¨åŒå‘é“¾è¡¨å®ç°çš„ï¼Œæ‰€ä»¥å‘åˆ—è¡¨ä¸¤ç«¯æ·»åŠ å…ƒç´ çš„æ—¶é—´å¤åˆ¶åº¦ä¸ºO(1)ï¼Œè·å–è¶Šæ¥è¿‘ä¸¤ç«¯çš„å…ƒç´ å°±è¶Šå¿«ã€‚</p>
<h4 id="å†…éƒ¨æ•°æ®ç»“æ„-1"><a href="#å†…éƒ¨æ•°æ®ç»“æ„-1" class="headerlink" title="å†…éƒ¨æ•°æ®ç»“æ„"></a>å†…éƒ¨æ•°æ®ç»“æ„</h4><p>åœ¨redis3.2ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œåˆ—è¡¨ç±»å‹çš„valueå¯¹è±¡å†…éƒ¨æ˜¯ä»¥linkedlistæˆ–ziplistæ¥å®ç°ï¼Œå½“åˆ—è¡¨åªåŒ…å«å°‘é‡å…ƒç´ ï¼Œå¹¶ä¸”æ¯ä¸ªå…ƒç´ è¦ä¹ˆæ˜¯å°æ•´æ•°å€¼ï¼Œè¦ä¹ˆæ˜¯é•¿åº¦ğŸ“’çŸ­çš„å­—ç¬¦ä¸²æ—¶ï¼ŒRediså°±ä¼šä½¿ç”¨å‹ç¼©é“¾è¡¨(zpilist)æ¥å­˜å‚¨æ¥èŠ‚çœå†…å­˜ï¼Œå¦åˆ™å°†ä¼šé‡‡ç”¨åŒå‘é“¾è¡¨ï¼ˆlinkedlistï¼‰å­˜å‚¨ã€‚åŒå‘é“¾è¡¨çš„èŠ‚ç‚¹ç»“æ„å¯ä»¥åœ¨redisæºç çš„<code>adlist.h</code>çœ‹åˆ°ï¼ŒlistNodeå…·ä½“ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> listNode <span class="token punctuation">{</span>
    <span class="token keyword">struct</span> listNode <span class="token operator">*</span>prev<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å‰ç½®èŠ‚ç‚¹</span>
    <span class="token keyword">struct</span> listNode <span class="token operator">*</span>next<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åç½®èŠ‚ç‚¹</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>value<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//èŠ‚ç‚¹çš„å€¼</span>
<span class="token punctuation">}</span> listNode<span class="token punctuation">;</span>
</code></pre>
<p>è™½ç„¶å¯ä»¥ä½¿ç”¨å¤šä¸ªlistNodeç»“æ„å°±èƒ½ç»„æˆé“¾è¡¨ï¼Œä½†æ˜¯ä½¿ç”¨ä¸€ä¸ªlistæ¥æŒæœ‰é“¾è¡¨çš„åŒ–ï¼Œæ“ä½œä¼šæ›´æ–¹ä¾¿ï¼Œlistå…·ä½“ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> list <span class="token punctuation">{</span>
    listNode <span class="token operator">*</span>head<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//é“¾è¡¨å¤´èŠ‚ç‚¹</span>
    listNode <span class="token operator">*</span>tail<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//é“¾è¡¨å°¾èŠ‚ç‚¹</span>
    <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>dup<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//èŠ‚ç‚¹å¤åˆ¶å‡½æ•°</span>
    <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>free<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//èŠ‚ç‚¹é‡Šæ”¾å‡½æ•°</span>
    <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>match<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>ptr<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//èŠ‚ç‚¹å¯¹æ¯”å‡½æ•°</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> len<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//é“¾è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°é‡</span>
<span class="token punctuation">}</span> list<span class="token punctuation">;</span>
</code></pre>
<p>åˆ—è¡¨çš„è¿™ä¸¤ç§å­˜å‚¨æ–¹å¼å„æœ‰ä¼˜ç¼ºç‚¹ï¼š</p>
<ul>
<li>åŒå‘é“¾è¡¨åœ¨é“¾è¡¨çš„ä¸¤ç«¯è¿›è¡Œæ·»åŠ å’Œåˆ é™¤æ“ä½œï¼Œæ—¶é—´å¤æŸ¥åº¦ä½ï¼Œä½†å†…å­˜å¼€é”€å¤§ï¼›</li>
<li>å‹ç¼©é“¾è¡¨å­˜å‚¨åœ¨ä¸€æ®µè¿ç»­çš„å†…å­˜ä¸Šï¼Œæ‰€ä»¥å­˜å‚¨æ•ˆç‡é«˜ï¼Œä½†æ˜¯æ’å…¥å’Œåˆ é™¤éƒ½è¦é¢‘ç¹ç”³è¯·å’Œé‡Šæ”¾å†…å­˜ï¼›</li>
</ul>
<p>åœ¨redis3.2ä¹‹åçš„ç‰ˆæœ¬ï¼Œé‡‡ç”¨äº†ä¸€ç§å«quicklistçš„æ•°æ®ç»“æ„æ¥å­˜å‚¨åˆ—è¡¨ç±»å‹çš„valueå€¼ï¼Œquicklistç»“æ„å‚è§Redisæºç <code>quicklist.h</code>ï¼ŒquicklistNodeçš„ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/* quicklistNode is a 32 byte struct describing a ziplist for a quicklist.
 * We use bit fields keep the quicklistNode at 32 bytes.
 * count: 16 bits, max 65536 (max zl bytes is 65k, so max count actually &lt; 32k).
 * encoding: 2 bits, RAW=1, LZF=2.
 * container: 2 bits, NONE=1, ZIPLIST=2.
 * recompress: 1 bit, bool, true if node is temporarry decompressed for usage.
 * attempted_compress: 1 bit, boolean, used for verifying during testing.
 * extra: 12 bits, free for future use; pads out the remainder of 32 bits */</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> quicklistNode <span class="token punctuation">{</span>
    <span class="token keyword">struct</span> quicklistNode <span class="token operator">*</span>prev<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å‰ç½®èŠ‚ç‚¹</span>
    <span class="token keyword">struct</span> quicklistNode <span class="token operator">*</span>next<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//åç½®èŠ‚ç‚¹</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token operator">*</span>zl<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ziplistèŠ‚ç‚¹</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> sz<span class="token punctuation">;</span>             <span class="token comment" spellcheck="true">/* ziplist size in bytes */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> count <span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">/* count of items in ziplist */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> encoding <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">/* RAW==1 or LZF==2 */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> container <span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">/* NONE==1 or ZIPLIST==2 */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> recompress <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* was this node previous compressed? */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> attempted_compress <span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* node can't compress; too small */</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> extra <span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">/* more bits to steal for future usage */</span>
<span class="token punctuation">}</span> quicklistNode<span class="token punctuation">;</span>
</code></pre>
<p>å¯ä»¥ä»ä¸Šé¢çš„ç»“æ„å®šä¹‰çœ‹å‡ºï¼Œquicklistæœ¬è´¨ä»»ç„¶æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œåªæ˜¯åœ¨åˆ—è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªziplist,å…¶å®å°±æ˜¯linkedlistå’Œziplistçš„ç»“åˆï¼Œquicklistä¸­æ¯ä¸ªèŠ‚ç‚¹ziplistéƒ½èƒ½å¤Ÿå­˜å‚¨å¤šä¸ªæ•°æ®å…ƒç´ ï¼Œåœ¨æºç ä¸­çš„æ–‡ä»¶ä¸º<code>quicklist.c</code>çš„ç¬¬ä¸€è¡Œå°±æœ‰è¿™æ ·çš„æè¿°ï¼šquicklist.c - A doubly linked list of ziplistsæ„æ€æ˜¯quicklistå°±æ˜¯æœ‰ziplistç»„æˆçš„åŒå‘é“¾è¡¨ã€‚</p>
<p><img src="/2019/03/20/RedisInAction/quicklist.png" alt></p>
<h4 id="å¸¸ç”¨å‘½ä»¤-1"><a href="#å¸¸ç”¨å‘½ä»¤-1" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><ol>
<li><p><strong>blpop</strong>ï¼šblpop key [key â€¦] timeoutï¼›blpopæ˜¯åˆ—è¡¨é˜»å¡å¼(blocking)å¼¹å‡ºåŸè¯­ã€‚å®ƒæ˜¯lpopå‘½ä»¤çš„é˜»å¡ç‰ˆæœ¬ï¼Œå½“ç»™å®šåˆ—è¡¨æ²¡æœ‰ä»»ä½•å…ƒç´ å¯ä¾›å¼¹å‡ºçš„æ—¶å€™ï¼Œè¿æ¥å°†è¢«blpopå‘½ä»¤é˜»å¡ï¼Œç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å…ƒç´ ä¸ºæ­¢ã€‚è¶…æ—¶å‚æ•° <code>timeout</code> æ¥å—ä¸€ä¸ªä»¥ç§’ä¸ºå•ä½çš„æ•°å­—ä½œä¸ºå€¼ã€‚è¶…æ—¶å‚æ•°è®¾ä¸º <code>0</code> è¡¨ç¤ºé˜»å¡æ—¶é—´å¯ä»¥æ— é™æœŸå»¶é•¿(block indefinitely) ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</p>
</li>
<li><p><strong>brpop</strong>ï¼šbrpop key [key â€¦] timeoutï¼›brpopæ˜¯åˆ—è¡¨çš„é˜»å¡å¼(blocking)å¼¹å‡ºåŸè¯­ã€‚å®ƒæ˜¯ rpopå‘½ä»¤çš„é˜»å¡ç‰ˆæœ¬ï¼Œå½“ç»™å®šåˆ—è¡¨å†…æ²¡æœ‰ä»»ä½•å…ƒç´ å¯ä¾›å¼¹å‡ºçš„æ—¶å€™ï¼Œè¿æ¥å°†è¢«brpopå‘½ä»¤é˜»å¡ï¼Œç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢ã€‚å¯ç”¨ç‰ˆæœ¬&gt;2.0.0ã€‚</p>
</li>
<li><p><strong>brpoplpush</strong>ï¼šbrpoplpush source destination timeoutï¼›brpoplpushæ˜¯rpoplpushçš„é˜»å¡ç‰ˆæœ¬ï¼Œå½“ç»™å®šåˆ—è¡¨sourceä¸ä¸ºç©ºæ—¶ï¼Œbrpoplpushçš„è¡¨ç°å’Œrpoplpushä¸€æ ·ã€‚å½“åˆ—è¡¨sourceä¸ºç©ºæ—¶brpoplpushå‘½ä»¤å°†é˜»å¡è¿æ¥ï¼Œç›´åˆ°ç­‰å¾…è¶…æ—¶ï¼Œæˆ–æœ‰å¦ä¸€ä¸ªå®¢æˆ·ç«¯å¤šsourceæ‰§è¡Œlpushæˆ–rpushå‘½ä»¤ä¸ºæ­¢ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.2.0ã€‚</p>
</li>
<li><p><strong>lindex</strong>ï¼šlindex key indexï¼›è¿”å›åˆ—è¡¨keyä¸­ï¼Œä¸‹æ ‡ä¸ºindexçš„å…ƒç´ ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>linsert</strong>ï¼šlinsert key before|after pivot valueï¼›å°†å€¼valueæ’å…¥åˆ°åˆ—è¡¨keyä¸­ï¼Œä½äºå€¼prvotä¹‹å‰æˆ–ä¹‹åã€‚å¯ç”¨ç‰ˆæœ¬&gt;2.2.0ã€‚</p>
</li>
<li><p><strong>llen</strong>ï¼šllen keyï¼›è¿”å›åˆ—è¡¨keyçš„é•¿åº¦ã€‚  å¦‚æœkeyä¸å­˜åœ¨ï¼Œåˆ™keyè¢«è§£é‡Šä¸ºä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œè¿”å›0ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>lpop</strong>ï¼šlpop keyï¼›ç§»é™¤å¹¶è¿”å›åˆ—è¡¨keyçš„å¤´å…ƒç´ ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>lpush</strong>ï¼šlpush key value [value â€¦]ï¼›å°†ä¸€ä¸ªæˆ–å¤šä¸ªvalueæ’å…¥åˆ°åˆ—è¡¨keyçš„è¡¨å¤´ã€‚å¦‚æœæœ‰å¤šä¸ªvalueå€¼ï¼Œé‚£ä¹ˆå„ä¸ªvalueå€¼æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºä¾æ¬¡æ’å…¥åˆ°è¡¨å¤´ã€‚æ‰§è¡Œlpushåè¿”å›åˆ—è¡¨çš„é•¿åº¦ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p><strong>lpushx</strong>ï¼šlpushx key valueï¼›å°†å€¼valueæ’å…¥åˆ°åˆ—è¡¨keyçš„è¡¨å¤´ï¼Œå½“ä¸”ä»…å½“keyå­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚å½“keyä¸å­˜åœ¨æ—¶ï¼Œlpushxå‘½ä»¤ä»€ä¹ˆä¹Ÿä¸åšã€‚lpushxå‘½ä»¤æ‰§è¡Œåï¼Œè¿”å›åˆ—è¡¨çš„é•¿åº¦ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.2.0ã€‚</p>
</li>
<li><p>lrangeï¼šlrange key start stopï¼›è¿”å›åˆ—è¡¨keyä¸­æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼ŒåŒºé—´ä»¥åç§»é‡startå’ŒstopæŒ‡å®šã€‚ä¸‹æ ‡å‚æ•°startå’Œendéƒ½æ˜¯ä»¥0å¼€å§‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥0è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä»¥1è¡¨ç¤ºåˆ—è¡¨çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨è´Ÿæ•°ä¸‹æ ‡ï¼Œä»¥-1è¡¨ç¤ºåˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œ-2è¡¨ç¤ºåˆ—è¡¨çš„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p>lremï¼šlrem key count valueï¼›ä¾æ®å‚æ•°countçš„å€¼ï¼Œç§»é™¤åˆ—è¡¨ä¸­ä¸å‚æ•°valueç›¸ç­‰çš„å…ƒç´ ã€‚è¿”å›è¢«ç§»é™¤å…ƒç´ çš„æ•°é‡ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
<p>countçš„å€¼å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p>
<ul>
<li>count &gt; 0ï¼šä»è¡¨å¤´å¼€å§‹å‘è¡¨å°¾æœç´¢ï¼Œç§»é™¤ä¸valueç›¸ç­‰çš„å…ƒç´ ï¼Œæ•°é‡ä¸ºcountï¼›</li>
<li>count &lt; 0ï¼šä»è¡¨å°¾å‘è¡¨å¤´æœç´¢ï¼Œç§»é™¤ä¸valueç›¸ç­‰çš„å…ƒç´ ï¼Œæ•°é‡ä¸ºcountçš„ç»å¯¹å€¼ã€‚</li>
<li>count = 0ï¼šç§»é™¤è¡¨ä¸­æ‰€æœ‰ä¸valueç›¸ç­‰çš„å€¼ã€‚</li>
</ul>
</li>
<li><p>lsetï¼šlset key index valueï¼›å°†åˆ—è¡¨keyä¸‹æ ‡ä¸ºindexçš„å…ƒç´ çš„å€¼è®¾ç½®ä¸ºvalueã€‚å½“indexå‚æ•°è¶…å‡ºèŒƒå›´ï¼Œæˆ–å¯¹ä¸€ä¸ªç©ºåˆ—è¡¨(keyä¸å­˜åœ¨)è¿›è¡Œlsetæ—¶ï¼Œè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚æ“ä½œæˆåŠŸè¿”å›okï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p>ltrimï¼šltrim key start stopï¼›å¯¹ä¸€ä¸ªåˆ—è¡¨è¿›è¡Œä¿®å‰ª(trim)ï¼Œå°±æ˜¯è¯´ï¼Œè®©åˆ—è¡¨åªä¿ç•™æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ ï¼Œä¸åœ¨æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ éƒ½å°†è¢«åˆ é™¤ã€‚å‘½ä»¤æ‰§è¡ŒæˆåŠŸè¿”å›okã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p>rpopï¼šrpop keyï¼›ç§»é™¤å¹¶è¿”å›åˆ—è¡¨keyçš„å°¾å…ƒç´ ã€‚å½“keyä¸å­˜åœ¨æ—¶ï¼Œè¿”å›nilã€‚</p>
</li>
<li><p>rpoplpushï¼šrpoplpush source destinationï¼›è¯¥å‘½ä»¤åœ¨ä¸€ä¸ªåŸå­æ—¶é—´å†…æ‰§è¡Œä¸¤ä¸ªæ“ä½œï¼š</p>
<ul>
<li>å°†åˆ—è¡¨sourceä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ (å°¾å…ƒç´ )å¼¹å‡ºï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
<li>å°†sourceå¼¹å‡ºçš„å…ƒç´ æ’å…¥åˆ°åˆ—è¡¨destinationï¼Œä½œä¸ºåˆ—è¡¨destinationçš„å¤´å…ƒç´ ã€‚</li>
</ul>
<p>å¦‚æœsourceä¸å­˜åœ¨ï¼Œè¿”å›nilï¼Œå¹¶ä¸æ‰§è¡Œå…¶ä»–åŠ¨ä½œã€‚å¦‚æœsourceå’Œdestinationç›¸åŒï¼Œåˆ™åˆ—è¡¨ä¸­çš„è¡¨å°¾å…ƒç´ è¢«ç§»åŠ¨åˆ°è¡¨å¤´ï¼Œå¹¶è¿”å›è¯¥å…ƒç´ ï¼Œå¯ä»¥æŠŠè¿™ç§ç‰¹æ®Šæƒ…å†µè§†ä½œåˆ—è¡¨çš„åè½¬ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.2.0ã€‚</p>
</li>
<li><p>rpushï¼šrpush key value [value â€¦]ï¼›å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼valueæ’å…¥åˆ—è¡¨keyçš„è¡¨å°¾(æœ€å³è¾¹)ã€‚å¦‚æœæœ‰å¤šä¸ªvalueå€¼ï¼Œé‚£ä¹ˆå„ä¸ªvalueå€¼æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºä¾æ¬¡æ’å…¥åˆ°è¡¨å°¾ã€‚rpushæ‰§è¡Œåï¼Œè¿”å›åˆ—è¡¨çš„é•¿åº¦ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</p>
</li>
<li><p>rpushxï¼šrpushx key valueï¼›å°†å€¼valueæ’å…¥åˆ—è¡¨keyçš„è¡¨å°¾ï¼Œå½“ä¸”ä»…å½“keyå­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚å½“keyä¸å­˜åœ¨æ—¶ï¼Œrpushxå‘½ä»¤ä»€ä¹ˆä¹Ÿä¸åšã€‚rpushxæ‰§è¡ŒæˆåŠŸåï¼Œè¿”å›åˆ—è¡¨çš„é•¿åº¦ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.2.0ã€‚</p>
</li>
</ol>
<h3 id="å“ˆå¸Œ-Hash"><a href="#å“ˆå¸Œ-Hash" class="headerlink" title="å“ˆå¸Œ(Hash)"></a>å“ˆå¸Œ(Hash)</h3><p>å“ˆå¸Œå¯ä»¥å­˜å‚¨å¤šä¸ªé”®å€¼å¯¹ä¹‹é—´çš„æ˜ å°„ï¼Œå’Œå­—ç¬¦ä¸²ä¸€æ ·ï¼Œå“ˆå¸Œå­˜å‚¨çš„å€¼æ—¢å¯ä»¥æ˜¯å­—ç¬¦ä¸²åˆå¯ä»¥æ˜¯æ•°å­—å€¼ã€‚</p>
<h4 id="å†…éƒ¨æ•°æ®ç»“æ„-2"><a href="#å†…éƒ¨æ•°æ®ç»“æ„-2" class="headerlink" title="å†…éƒ¨æ•°æ®ç»“æ„"></a>å†…éƒ¨æ•°æ®ç»“æ„</h4><p>å“ˆå¸Œç±»å‹çš„å†…éƒ¨æ•°æ®ç»“æ„å¯ä»¥æ˜¯ziplistæˆ–è€…hashtableã€‚å½“å“ˆå¸Œä¿å­˜çš„æ‰€æœ‰é”®å€¼å¯¹çš„é”®å’Œå€¼å¾—å­—ç¬¦ä¸²å¤§å°éƒ½å°äº64å­—èŠ‚ï¼Œå¹¶ä¸”é”®å€¼å¯¹çš„æ•°é‡å°äº512ä¸ªæ—¶ï¼Œåº•å±‚å°†ä¼šé‡‡ç”¨ziplistå­˜å‚¨ç»“æ„ï¼Œå¦åˆ™å°†é‡‡ç”¨hashtableå­˜å‚¨ç»“æ„ã€‚åœ¨redisä¸­ï¼Œhashtableæœ‰3å±‚ç»“æ„ï¼Œdict -&gt; dictht -&gt; dictEntryï¼Œæºç åœ¨<code>dict.h</code>ä¸­ã€‚</p>
<p><strong>dictEntryï¼ˆå“ˆå¸ŒèŠ‚ç‚¹ï¼‰</strong></p>
<p>ç®¡ç†ä¸€ä¸ªkey-valueï¼ŒåŒæ—¶ä¿ç•™åŒä¸€ä¸ªæ¡¶ä¸­ç›¸é‚»å…ƒç´ çš„æŒ‡é’ˆï¼Œç”¨æˆ·ç»´æŠ¤å“ˆå¸Œæ¡¶çš„å†…éƒ¨é“¾è¡¨ï¼Œç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> dictEntry <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">;</span>
    <span class="token keyword">union</span> <span class="token punctuation">{</span>
        <span class="token keyword">void</span> <span class="token operator">*</span>val<span class="token punctuation">;</span>
        uint64_t u64<span class="token punctuation">;</span>
        int64_t s64<span class="token punctuation">;</span>
        <span class="token keyword">double</span> d<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> v<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å› ä¸ºvalueæœ‰å¤šç§ç±»å‹ï¼Œæ‰€ä»¥valueç”¨äº†unionæ¥å­˜å‚¨</span>
    <span class="token keyword">struct</span> dictEntry <span class="token operator">*</span>next<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„åœ°å€ï¼Œç”¨æ¥å¤„ç†å†²çªï¼Œæ‰€ä»¥åˆ†é…åˆ°åŒä¸€ä¸ªç´¢å¼•çš„å…ƒç´ é€šè¿‡nextæŒ‡é’ˆé“¾æ¥èµ·æ¥å½¢æˆé“¾è¡¨</span>
<span class="token punctuation">}</span> dictEntry<span class="token punctuation">;</span>
</code></pre>
<p><strong>dicthtï¼ˆå“ˆå¸Œè¡¨ï¼‰</strong> </p>
<p>å®ç°ä¸€ä¸ªhashtableä¼šç”¨ä¸€ä¸ªbuckerså­˜æ”¾dictEntryåœ°å€ï¼Œä¸€èˆ¬æƒ…å†µä¸‹é€šè¿‡hash(key) % lenå¾—åˆ°çš„å€¼å°±æ˜¯buckersçš„ç´¢å¼•ï¼Œè¿™ä¸ªå€¼å†³å®šäº†dictEntryèŠ‚ç‚¹çš„å­˜æ”¾ä½ç½®ï¼Œ<code>dict.h</code>ä¸­çš„dicthtç»“æ„ä¸­tableå°±æ˜¯buckersçš„åœ°å€ã€‚</p>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">/* This is our hash table structure. Every dictionary has two of this as we
 * implement incremental rehashing, for the old to the new table. */</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> dictht <span class="token punctuation">{</span>
    dictEntry <span class="token operator">*</span><span class="token operator">*</span>table<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//bucketsçš„åœ°å€</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> size<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//buckertsçš„å¤§å°ï¼Œæ€»ä¿æŒä¸º2^n</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> sizemask<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//æ©ç ï¼Œç”¨æ¥æŠ€æœ¯hashå€¼å¯¹åº”çš„buckersç´¢å¼•</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">long</span> used<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//å½“å‰dicthtæœ‰å¤šå°‘ä¸ªdictEntryèŠ‚ç‚¹</span>
<span class="token punctuation">}</span> dictht<span class="token punctuation">;</span>
</code></pre>
<p><strong>dictï¼ˆå­—å…¸ï¼‰</strong>                                                                           </p>
<p>dicthtå®é™…ä¸Šå°±æ˜¯hashè¡¨çš„æ ¸å¿ƒï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªdicthtè¿˜ä¸å¤Ÿï¼Œæ¯”å¦‚rehashã€éå†hashç­‰æ“ä½œï¼Œæ‰€ä»¥rediså®šä¹‰äº† ä¸€ä¸ªå«dictçš„ç»“æ„ä»¥æ”¯æŒå­—å…¸çš„å„ç§æ“ä½œï¼Œå½“dicthtéœ€è¦æ‰©å®¹/ç¼©å®¹æ—¶ï¼Œç”¨æ¥ç®¡ç†dicthtçš„è¿ç§»ï¼Œä»¥ä¸‹æ˜¯å®ƒçš„æ•°æ®ç»“æ„:</p>
<pre class=" language-c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">struct</span> dict <span class="token punctuation">{</span>
    dictType <span class="token operator">*</span>type<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//dictTypeé‡Œå­˜æ”¾çš„æ˜¯å·¥å…·å‡½æ•°çš„æŒ‡é’ˆ</span>
    <span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ä¿å­˜typeä¸­æŸäº›å‡½æ•°éœ€è¦ä½œä¸ºå‚æ•°çš„æ•°æ®</span>
    dictht ht<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ç»´æŠ¤ä¸¤ä¸ªdicthtï¼Œht[0]å¹³æ—¶ç”¨ï¼Œht[1]rehashæ—¶ç”¨</span>
    <span class="token keyword">long</span> rehashidx<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å½“å‰rehashåˆ°buckertsçš„å“ªä¸ªç´¢å¼•ä½ç½®ï¼Œ-1è¡¨ç¤ºérehashçŠ¶æ€</span>
    <span class="token keyword">int</span> iterators<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å®‰å…¨è¿­ä»£å™¨çš„è®¡æ•°</span>
<span class="token punctuation">}</span> dict<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//å·¥å…·å‡½æ•°</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span> dictType <span class="token punctuation">{</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>hashFunction<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>keyDup<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">*</span>valDup<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>keyCompare<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>key1<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">void</span> <span class="token operator">*</span>key2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>keyDestructor<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>valDestructor<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>privdata<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token operator">*</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> dictType<span class="token punctuation">;</span>
</code></pre>
<p><strong>dictçš„ç»“æ„å›¾</strong>ï¼š</p>
<p><img src="/2019/03/20/RedisInAction/dict.png" alt></p>
<p><strong>å“ˆå¸Œç®—æ³•</strong></p>
<p>å½“è¦è®²ä¸€ä¸ªæ–°çš„é”®å€¼å¯¹æ·»åŠ åˆ°dicté‡Œé¢æ—¶ï¼Œç¨‹åºéœ€è¦å…ˆæ ¹æ®é”®è®¡ç®—å‡ºå“ˆå¸Œå€¼å’Œç´¢å¼•å€¼ï¼Œç„¶ååœ¨æ ¹æ®ç´¢å¼•å€¼å°†é”®å€¼å¯¹çš„å“ˆå¸Œè¡¨èŠ‚ç‚¹æ”¾åˆ°å“ˆå¸Œæ•°ç»„çš„æŒ‡å®šç´¢å¼•ä¸Šé¢ã€‚</p>
<pre class=" language-tex"><code class="language-tex">#ä½¿ç”¨dictè®¾ç½®çš„å“ˆå¸Œå‡½æ•°ï¼Œè®¡ç®—keyçš„å“ˆå¸Œå€¼
hash = dict -> type -> hashFunction(key);

#ä½¿ç”¨å“ˆå¸Œè¡¨çš„sizemaskå±æ€§å’Œå“ˆå¸Œå€¼ï¼Œè®¡ç®—å‡ºç´¢å¼•å€¼ï¼›æ ¹æ®æƒ…å†µä¸åŒï¼Œht[x]å¯ä»¥æ˜¯ht[0]æˆ–ht[1]
index = hash & dict -> hx[x].sizemask;

</code></pre>
<p>Redisä½¿ç”¨<strong>MurmurHash2</strong>ç®—æ³•æ¥è®¡ç®—é”®çš„å“ˆå¸Œå€¼ã€‚<strong>MurmuhHashç®—æ³•</strong>æœ€åˆç”±Austin Applebyäº2008å¹´å‘æ˜ï¼Œè¿™ä¸ªç®—æ³•çš„ä¼˜ç‚¹åœ¨äºå³ä½¿è¾“å…¥çš„é”®æ˜¯ç”±è§„å¾‹çš„ï¼Œç®—æ³•ä»èƒ½ç»™å‡ºä¸€ä¸ªå¾ˆå¥½çš„éšæœºåˆ†å¸ƒè¡Œï¼Œå¹¶ä¸”ç®—æ³•çš„è®¡ç®—é€Ÿåº¦ä¹Ÿå¾ˆå¿«ã€‚</p>
<p><strong>è§£å†³å“ˆå¸Œå†²çª</strong></p>
<p>å½“æœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„é”®è¢«åˆ†é…åˆ°å“ˆå¸Œè¡¨æ•°ç»„çš„åŒä¸€ä¸ªç´¢å¼•ä¸Šé¢æ—¶ï¼Œå°±ç§°è¿™äº›é”®å‘ç”Ÿäº†å†²çªï¼ˆconllisionï¼‰ã€‚Redisçš„å“ˆå¸Œç±»å‹ä½¿ç”¨<strong>é“¾åœ°å€æ³•</strong>æ¥è§£å†³å†²çªï¼Œæ¯ä¸ªå“ˆå¸ŒèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªnextæŒ‡é’ˆï¼Œå¤šä¸ªå“ˆå¸ŒèŠ‚ç‚¹å¯ä»¥ç”¨nextæŒ‡é’ˆæ„æˆä¸€ä¸ªå•å‘é“¾è¡¨ï¼Œè¢«åˆ†é…åˆ°åŒä¸€ä¸ªç´¢å¼•ä¸Šçš„å¤šä¸ªèŠ‚ç‚¹å¯ä»¥ç”¨è¿™ä¸ªå•å‘é“¾è¡¨è¿æ¥èµ·æ¥ï¼Œè¿™å°±è§£å†³äº†é”®å†²çªé—®é¢˜ã€‚</p>
<p><strong>Rehash</strong></p>
<p>éšç€æ“ä½œçš„ä¸æ–­æ‰§è¡Œï¼Œå“ˆå¸Œè¡¨ä¿å­˜çš„é”®å€¼å¯¹ä¼šé€æ¸åœ°å¢å¤šæˆ–å‡å°‘ï¼Œä¸ºäº†è®©å“ˆå¸Œè¡¨çš„è´Ÿè½½å› å­ç»´æŒåœ¨ä¸€ä¸ªåˆç†çš„èŒƒå›´ä¹‹å†…ï¼Œå½“å“ˆå¸Œè¡¨ä¿å­˜çš„é”®å€¼å¯¹æ•°é‡å¤§å¤šæˆ–å¤ªå°‘æ—¶ï¼Œéƒ½éœ€è¦å¯¹å“ˆå¸Œè¡¨çš„å¤§å°è¿›è¡Œç›¸åº”çš„æ‰©å±•æˆ–ç¼©å°ã€‚</p>
<p>æ‰©å±•å’Œç¼©å°å“ˆå¸Œè¡¨çš„å·¥ä½œå¯ä»¥é€šè¿‡æ‰§è¡Œrehash(é‡æ–°æ•£åˆ—)æ“ä½œæ¥å®Œæˆï¼ŒRediså¯¹å­—å…¸çš„å“ˆå¸Œè¡¨æ‰§è¡Œrehashçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>ä¸ºå­—å…¸çš„ht[1]å“ˆå¸Œè¡¨åˆ†é…å†…å­˜ç©ºé—´ï¼Œè¿™ä¸ªå“ˆå¸Œè¡¨çš„ç©ºé—´å¤§å°å–å†³äºè¦æ‰§è¡Œçš„æ“ä½œä¾æ®ht[0]å“ˆå¸Œè¡¨åŒ…å«çš„é”®å€¼å¯¹çš„æ•°é‡(å³ht[0].usedå±æ€§çš„å€¼)ã€‚</p>
<ul>
<li>å¦‚æœæ‰§è¡Œçš„æ˜¯æ‰©å±•æ“ä½œï¼Œé‚£ä¹ˆht[1]çš„å¤§å°ä¸ºç¬¬ä¸€ä¸ªå¤§äºç­‰äºht[0].used*2çš„2^nï¼ˆ2çš„næ¬¡æ–¹ï¼‰ï¼›</li>
<li>å¦‚æœæ‰§è¡Œçš„æ˜¯æ”¶ç¼©æ“ä½œï¼Œé‚£ä¹ˆht[1]çš„å¤§å°ä¸ºç¬¬ä¸€ä¸ªå¤§äºç­‰äºht[0].usedçš„2^nï¼›</li>
</ul>
</li>
<li><p>å°†ä¿å­˜åœ¨ht[0]ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹rehashåˆ°ht[1]ä¸Šé¢ã€‚</p>
</li>
<li>å½“ht[0]åŒ…å«çš„æ‰€æœ‰é”®å€¼å¯¹éƒ½è¿ç§»åˆ°äº†ht[1]ä¹‹åï¼Œå°±æŠŠht[0]ç½®ä¸ºç©ºè¡¨ï¼Œé‡Šæ”¾ht[0]ï¼Œç„¶åå°†ht[1]è®¾ç½®ä¸ºht[0]ï¼Œå¹¶ä¸ºht[1]æ–°å»ºä¸€ä¸ªç©ºçš„å“ˆå¸Œè¡¨ï¼Œä¸ºä¸‹æ¬¡rehashåšå‡†å¤‡ã€‚</li>
</ul>
<h4 id="å¸¸ç”¨å‘½ä»¤-2"><a href="#å¸¸ç”¨å‘½ä»¤-2" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><ol>
<li><strong>hdel</strong>ï¼šhdel key field [field â€¦]ï¼›åˆ é™¤å“ˆå¸Œè¡¨çš„ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡å®šåŸŸï¼Œä¸å­˜åœ¨çš„åŸŸå°†è¢«å¿½ç•¥ã€‚è¿”å›è¢«æˆåŠŸåˆ é™¤çš„åŸŸçš„æ•°é‡ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hexists</strong>ï¼šhexists key fieldï¼›æŸ¥çœ‹å“ˆäº›è¡¨keyä¸­ï¼Œç»™å®šçš„fieldæ˜¯å¦å­˜åœ¨ã€‚å¦‚æœå­˜åœ¨ï¼Œè¿”å›1ï¼›å¦‚æœå“ˆå¸Œè¡¨ä¸å«æœ‰ç»™å®šåŸŸï¼Œæˆ–keyä¸å­˜åœ¨ï¼Œè¿”å›0ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hget</strong>ï¼šhget key fieldï¼›è¿”å›å“ˆå¸Œè¡¨keyä¸­ç»™å®šåŸŸfieldçš„å€¼ã€‚å¦‚æœç»™å®šçš„åŸŸä¸å­˜åœ¨æˆ–æ˜¯ç»™å®škeyä¸å­˜åœ¨æ—¶ï¼Œè¿”å›nilã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hgetall</strong>ï¼šhgetall keyï¼›è¿”å›å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰çš„åŸŸå’Œå€¼ã€‚è‹¥keyä¸å­˜åœ¨ï¼Œè¿”å›ç©ºåˆ—è¡¨ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hincrby</strong>ï¼šhincrby key field incrementï¼›ä¸ºå“ˆå¸Œè¡¨keyä¸­çš„åŸŸfieldçš„å€¼åŠ ä¸Šå¢é‡incrementã€‚å¢é‡ä¹Ÿå¯ä»¥æ˜¯è´Ÿæ•°ï¼Œç›¸å½“äºå¯¹ç»™å®šåŸŸè¿›è¡Œå‡æ³•æ“ä½œã€‚å¦‚æœkeyä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°çš„å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶æ‰§è¡Œhincrbyå‘½ä»¤ã€‚å¦‚æœåŸŸfieldä¸å­˜åœ¨ï¼Œé‚£ä¹ˆåœ¨æ‰§è¡Œå‘½ä»¤å‰ï¼ŒåŸŸçš„å€¼è¢«åˆå§‹åŒ–ä¸º0ã€‚å¯¹ä¸€ä¸ªå­˜å‚¨å­—ç¬¦ä¸²å€¼å¾—åŸŸfieldæ‰§è¡Œhincrbyå‘½ä»¤ï¼Œä¼šè¿”å›é”™è¯¯ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hincrbyfloat</strong>ï¼šhincrbyfloat key field incrementï¼›ä¸ºå“ˆå¸Œè¡¨keyä¸­çš„fieldåŠ ä¸Šæµ®ç‚¹æ•°å¢é‡Incrementã€‚å¦‚æœå“ˆå¸Œè¡¨ä¸­æ²¡æœ‰åŸŸfieldï¼Œé‚£ä¹ˆhincrbyfloatä¼šå…ˆå°†åŸŸfieldçš„å€¼è®¾ä¸º0ï¼Œç„¶åå†æ‰§è¡ŒåŠ æ³•æ“ä½œã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.6.0ã€‚</li>
<li><strong>hkeys</strong>ï¼šhkeys keyï¼›è¿”å›å“ˆå¸Œè¡¨keyä¸­çš„æ‰€æœ‰åŸŸã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hlen</strong>ï¼šhlen keyï¼›è¿”å›å“ˆå¸Œè¡¨keyä¸­åŸŸçš„æ•°é‡ã€‚å½“key ä¸å­˜åœ¨æ—¶è¿”å›0ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=1.0.0ã€‚</li>
<li><strong>hmget</strong>ï¼šhmget key field [field â€¦]ï¼›è¿”å›å“ˆå¸Œè¡¨keyä¸­ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªç»™å®šåŸŸçš„å€¼ã€‚å¦‚æœç»™å®šçš„åŸŸä¸å­˜åœ¨äºå“ˆå¸Œè¡¨ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ªnilå€¼ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hmset</strong>ï¼šhmset key field value [field value â€¦]ï¼›åŒæ—¶å°†å¤šä¸ªfield-valueè®¾ç½®åˆ°å“ˆå¸Œè¡¨keyä¸­ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hset</strong>ï¼šhset key field valueï¼›å°†å“ˆå¸Œè¡¨keyä¸­çš„åŸŸfieldçš„å€¼è®¾ä¸ºvalueã€‚å¦‚æœkeyä¸å­˜åœ¨ï¼Œä¸€ä¸ªæ–°çš„å“ˆå¸Œè¡¨è¢«åˆ›å»ºå¹¶è¿›è¡Œhsetæ“ä½œã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hsetnx</strong>ï¼šhsetnx key field valueï¼›å°†å“ˆå¸Œè¡¨keyä¸­çš„åŸŸfieldçš„å€¼è®¾ç½®ä¸ºvalueï¼Œå½“ä¸”ä»…å½“åŸŸfieldä¸å­˜åœ¨ã€‚è®¾ç½®æˆåŠŸï¼Œè¿”å›1ï¼›å¦‚æœç»™å®šåŸŸå·²ç»å­˜åœ¨æ–Œåˆ«æ²¡æœ‰æ“ä½œè¢«æ‰§è¡Œï¼Œè¿”å›0ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hvals</strong>ï¼šhvals keyï¼›è¿”å›å“ˆå¸Œè¡¨keyä¸­æ‰€æœ‰åŸŸçš„å€¼ã€‚è¿”å›ä¸€ä¸ªåŒ…å«å“ˆå¸Œè¡¨ä¸­æ‰€æœ‰å€¼çš„è¡¨ï¼›å¦‚æœkeyä¸å­˜åœ¨ï¼Œè¿”å›ä¸€ä¸ªç©ºè¡¨ã€‚å¯ç”¨ç‰ˆæœ¬&gt;=2.0.0ã€‚</li>
<li><strong>hscan</strong>ï¼šhsan key cursor [match pattern] [count count]ï¼›</li>
</ol>

            </div>
            <hr>

            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>å¾®ä¿¡é‡Œç‚¹â€œå‘ç°â€->â€œæ‰«ä¸€æ‰«â€äºŒç»´ç ä¾¿å¯æŸ¥çœ‹åˆ†äº«ã€‚</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;è½¬è½½è¯·æ³¨æ˜:
                    </span>
                    <a href="https://lanchunqiu.github.io" class="b-link-green">lanchunqiu.github.io</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2019/03/20/RedisInAction/" class="b-link-green">Rediså®æˆ˜</a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2019/03/23/SerializeAndDeserializeBinaryTree/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/5.jpg" class="responsive-img" alt="åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸€ä¸ªäºŒå‰æ ‘">
                        
                        <span class="card-title">åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸€ä¸ªäºŒå‰æ ‘</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">é¢˜ç›®æè¿°åºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªæ•°æ®ç»“æ„æˆ–è€…å¯¹è±¡è½¬æ¢ä¸ºè¿ç»­çš„æ¯”ç‰¹ä½çš„æ“ä½œï¼Œè¿›è€Œå¯ä»¥å°†è½¬æ¢åçš„æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶æˆ–è€…å†…å­˜ä¸­ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°å¦ä¸€ä¸ªè®¡ç®—æœºç¯å¢ƒï¼Œé‡‡å–ç›¸åæ–¹å¼é‡æ„å¾—åˆ°åŸæ•°æ®ã€‚
è¯·è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥å®ç°äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€‚è¿™é‡Œä¸é™å®š</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2019-03-23
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/äºŒå‰æ ‘/" class="post-category" target="_blank">
                                    äºŒå‰æ ‘
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java/" target="_blank">
                        <span class="chip bg-color">Java</span>
                    </a>
                    
                    <a href="/tags/LeetCode/" target="_blank">
                        <span class="chip bg-color">LeetCode</span>
                    </a>
                    
                    <a href="/tags/äºŒå‰æ ‘/" target="_blank">
                        <span class="chip bg-color">äºŒå‰æ ‘</span>
                    </a>
                    
                    <a href="/tags/åºåˆ—åŒ–/" target="_blank">
                        <span class="chip bg-color">åºåˆ—åŒ–</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2019/03/17/SearchIn2DArray/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/20.jpg" class="responsive-img" alt="äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾">
                        
                        <span class="card-title">äºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">é¢˜ç›®æè¿°åœ¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä¸­ï¼ˆæ¯ä¸ªä¸€ç»´æ•°ç»„çš„é•¿åº¦ç›¸åŒï¼‰ï¼Œæ¯ä¸€è¡Œéƒ½æŒ‰ç…§ä»å·¦åˆ°å³é€’å¢çš„é¡ºåºæ’åˆ—ï¼Œæ¯ä¸€åˆ—éƒ½æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹é€’å¢çš„é¡ºåºæ’åˆ—ã€‚è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥è¿™æ ·çš„ä¸€ä¸ªäºŒç»´æ•°ç»„å’Œä¸€ä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ•´æ•°æ˜¯å¦åœ¨äºŒç»´æ•°ç»„ä¸­ã€‚

è§£æ³•ä¸€ï¼šæš´åŠ›è§£æ³•æš´åŠ›è§£æ³•æ˜¯æœ€å®¹æ˜“æƒ³åˆ°</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2019-03-17
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/ç®—æ³•/" class="post-category" target="_blank">
                                    ç®—æ³•
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java/" target="_blank">
                        <span class="chip bg-color">Java</span>
                    </a>
                    
                    <a href="/tags/ç®—æ³•/" target="_blank">
                        <span class="chip bg-color">ç®—æ³•</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


    </div>
    <div class="col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;ç›®å½•</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            æœ¬ç«™ç”±&copy;<a href="https://blinkfox.github.io/" target="_blank">Blinkfox</a>åŸºäº
            <a href="https://hexo.io/" target="_blank">Hexo</a> çš„
            <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">hexo-theme-matery</a>ä¸»é¢˜æ­å»º.

            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    æœ¬ç«™æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    æ¬¡,&nbsp;è®¿å®¢æ•° <span id="busuanzi_value_site_uv" class="white-color"></span> äºº.
                </span>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">





</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—" class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->



    <script src="/libs/others/clicklove.js"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


</body>
</html>